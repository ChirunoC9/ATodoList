<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:ATodoList.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        xmlns:modles="using:ATodoList.Models"
		xmlns:views="using:ATodoList.Views"
        x:Class="ATodoList.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="ATodoList"
		MinWidth="800"
		MinHeight="600"
        Width="1080"
        Height="720"
        TransparencyLevelHint="AcrylicBlur"
        Background="Transparent"
        ExtendClientAreaToDecorationsHint="True"
        WindowStartupLocation="CenterScreen"
        >

	<Design.DataContext>
		<!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
		<vm:MainWindowViewModel/>
	</Design.DataContext>

	<Window.Resources>
		<views:TextLineCaseConverter x:Key="TextLineCaseConverter"/>
		<views:TextColorFinishCaseConverter x:Key="TextColorFinishCaseConverter"/>
	</Window.Resources>

	<Window.Styles>
		<!--
		<Style Selector="ListBox#panel ListBoxItem > ContentPresenter">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="IsHitTestVisible" Value=""/> 
		</Style>
	
		-->

	</Window.Styles>

	<Panel>
		<!--
            ‰∫öÂÖãÂäõ
        -->
		<ExperimentalAcrylicBorder IsHitTestVisible="False">
			<ExperimentalAcrylicBorder.Material>
				<ExperimentalAcrylicMaterial
                    BackgroundSource="Digger"
                    TintColor="Black"
                    TintOpacity="0.9"
                    MaterialOpacity="0.75" />
			</ExperimentalAcrylicBorder.Material>
		</ExperimentalAcrylicBorder>

		<Grid ColumnDefinitions="*, 1, 3*">

			<!-- Â∑¶Ëæπ -->
			<DockPanel Grid.Column="0"
                       Margin="30">
				<!-- ÊòæÁ§∫‰ø°ÊÅØ -->
				<StackPanel DockPanel.Dock="Top"
                            Margin="0 5">
					<TextBlock HorizontalAlignment="Center">
                        <PathIcon Data="{StaticResource preview_link_regular}"/> ATodoList
                    </TextBlock>
				</StackPanel>

				<!-- Ê∑ªÂä†ÈõÜÂêà -->
				<Grid DockPanel.Dock="Bottom"
					  ColumnDefinitions="*,3*"
					  RowDefinitions="*">
					<RepeatButton Grid.Column="0"
							Margin="2 0"
						    Classes="Primary"
						    Theme="{DynamicResource SolidButton}"
						    Click="CommitGroupNmaeButton_CommitClick"
						    x:Name="CommitGroupNameButton"
							ToolTip.Tip="Êèê‰∫§ÂæÖÂäû‰∫ãÈ°πÁªÑ">
						<PathIcon Data="{StaticResource arrow_curve_up_right_regular}"
								  Foreground="Red"/>
					</RepeatButton>
					<TextBox Grid.Column="1"
							 Margin="2 0"
							 TextWrapping="NoWrap"
							 Name="InputGroupName"
				             Watermark="Ê∑ªÂä†ÁªÑ..."
							 TextChanged="InputGroupTextBox_TextChanged"
				             Text="{Binding InputGroupName}"
							 x:Name="InputGroupNameTextBox"
							 ToolTip.Tip="Ê∑ªÂä†ÂæÖÂäû‰∫ãÈ°πÁªÑ"/>
				</Grid>

				<!-- item -->
				<ListBox Name="GroupItemList"
						 ItemsSource="{Binding GroupItems}"
                         Margin="0 5"
					     SelectionChanged="GroupItemList_SelectionChanged">
					<ListBox.ContextMenu>
						<ContextMenu Name="GroupItemList_ContextMenu">
							<MenuItem Header="ÈáçÂëΩÂêç">
								<MenuItem.Icon>
									<TextBlock>üòä</TextBlock>
								</MenuItem.Icon>
								<TextBox HorizontalAlignment="Stretch"
										 Watermark="Êñ∞ÂêçÂ≠ó"
										 TextWrapping="NoWrap"
										 KeyDown="GroupItemList_ContextMenu_TextBoxKeyDown_EnterSubmit"
										 Width="100"/>
							</MenuItem>
							<MenuItem Header="Â§çÂà∂"
									  Click="Async_GroupItemList_ContextMenu_CopyMenuItem_CopyGroupName"/>
							<MenuItem Header="Âà†Èô§"
									  Click="GroupItemList_ContextMenu_RemoveMeunItem_RemoveSelectedGroup"/>
						</ContextMenu>
					</ListBox.ContextMenu>

					<ListBox.ItemTemplate>
						<DataTemplate x:DataType="modles:TodoGroupItem">
							<StackPanel HorizontalAlignment="Center"
										Orientation="Horizontal">
								<TextBlock Text="{Binding Name}"/>
							</StackPanel>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>

			</DockPanel>

			<!-- Á∫ø-->
			<GridSplitter Grid.Column="1"
						  Background="WhiteSmoke"
			              Margin="5 30"
			              Opacity="0.4"
			              ResizeDirection="Columns"/>

			<!-- Âè≥Ëæπ -->
			<DockPanel Grid.Column="2"
					   Margin="40 30">
				<!-- ÁªÑÊ†áÈ¢ò -->
				<StackPanel DockPanel.Dock="Top"
							Spacing="10">
					<TextBlock Text="{Binding SelectedGroupName}"
							   FontSize="24"
				               Foreground="Aquamarine"/>
					<TabControl/>
				</StackPanel>

				<!-- Ê∑ªÂä† -->
				<TextBox DockPanel.Dock="Bottom"
						 BorderBrush="Aquamarine"
						 Watermark="Ê∑ªÂä†Êñ∞ÂæÖÂäû‰∫ãÈ°π..."
						 ToolTip.Tip="ËæìÂÖ•Êñ∞ÂæÖÂäû‰∫ãÈ°πÊ†áÈ¢ò"
						 ToolTip.ShowDelay="3"
						 KeyDown="AddTodoItemList_InputTextBox_PressEnterCommit">

				</TextBox>

				<TreeView Margin="5">
					<!-- Êú™ÂÆåÊàêÁªÑ -->
					<TreeViewItem IsExpanded="True">
						<TreeViewItem.Header>
							<StackPanel Orientation="Horizontal">
								<TextBlock Text="Êú™ÂÆåÊàêÔºö"/>
								<TextBlock Text="{Binding CurrentTodoGroupYieldFinishItems.Length}"/>
							</StackPanel>
						</TreeViewItem.Header>

						<ListBox ItemsSource="{Binding CurrentTodoGroupYieldFinishItems}"
								 Name="YieldFinishTodoItemListBox">
							<ListBox.ContextMenu>
								<ContextMenu Name="TodoGroupYieldItems_ContextMenu">
									<MenuItem Header="Â§çÂà∂"
											  Click="Async_CopySelectedYieldTodoItemTitle"
											  ToolTip.Tip="Â§çÂà∂ÈÄâ‰∏≠ÂæÖÂäû‰∫ãÈ°πÊ†áÈ¢ò"
											  ToolTip.ShowDelay="3"/>
									<MenuItem Header="Âà†Èô§"
											  Click="RemoveSelectedYieldTodoItemTitle"
											  ToolTip.Tip="Âà†Èô§ÈÄâ‰∏≠ÂæÖÂäû‰∫ãÈ°π"
											  ToolTip.ShowDelay="3"/>
								</ContextMenu>
							</ListBox.ContextMenu>

							<ListBox.ItemTemplate>
								<DataTemplate x:DataType="modles:TodoItem">
									<!-- ÈÄâÈ°πÂç° -->
									<Expander HorizontalContentAlignment="Stretch"
										  Expanded="TodoItemListBox_Expander_Expanded">
										<Expander.Header>
											<DockPanel>
												<CheckBox DockPanel.Dock="Left"
														  IsChecked="{Binding IsFinish}"
														  Checked="TodoGroupItems_SwitchTodoItemFinishStatus"
														  Unchecked="TodoGroupItems_SwitchTodoItemFinishStatus">
													<StackPanel>
														<TextBlock Text="{Binding Title}"/>
														<StackPanel Orientation="Horizontal">
															<TextBlock Text="Êà™Ê≠¢Êó∂Èó¥Ôºö"
																	   Opacity="0.8"
																	   Foreground="WhiteSmoke"/>
															<TextBlock Text="{Binding DeadLine}"
																	   Opacity="0.8"
																	   Foreground="WhiteSmoke"/>
														</StackPanel>
													</StackPanel>
												</CheckBox>
											</DockPanel>
										</Expander.Header>

										<!-- ËØ¶ÁªÜ‰ø°ÊÅØ -->

										<Grid ColumnDefinitions="*"
											  RowDefinitions="*,*,*,*">
											<TextBox Name="InputTitle"
													 Grid.Row="0"
													 Grid.Column="0"
													 HorizontalAlignment="Stretch"
													 VerticalAlignment="Center"
													 Text="{Binding Title}"
													 Watermark="Ê†áÈ¢ò..."
												     TextWrapping="NoWrap"
													 ToolTip.Tip="ËæìÂÖ•Ê†áÈ¢ò"
													 ToolTip.ShowDelay="3"/>

											<CalendarDatePicker Name="InputDeadLine"
																Grid.Row="1"
																Grid.Column="0"
																HorizontalAlignment="Stretch"
																VerticalAlignment="Center"
																IsTodayHighlighted="True"
																SelectedDate="{Binding DeadLine}"
																ToolTip.Tip="Êà™Ê≠¢Êó•Êúü"
																ToolTip.ShowDelay="3"/>

											<TextBox Name="InputDescription"
													 Grid.Row="2"
													 Grid.Column="0"
													 HorizontalAlignment="Stretch"
													 VerticalAlignment="Stretch"
													 Height="100"
												     Text="{Binding Description}"
													 Watermark="Ê∑ªÂä†Â§áÊ≥®..."
													 AcceptsReturn="True"
													 TextWrapping="Wrap"
													 TextAlignment="Justify"
													 ToolTip.Tip="Â§áÊ≥®"
													 ToolTip.ShowDelay="3"/>

											<TextBlock/>

											<Button Grid.Row="3"
													Grid.Column="0"
													HorizontalAlignment="Stretch"
													VerticalAlignment="Stretch"
													Classes="Success"
													Theme="{DynamicResource SolidButton}"
													Click="TodoItemList_CommitTodoItemInfo">
												Êèê‰∫§
											</Button>
										</Grid>

									</Expander>
								</DataTemplate>
							</ListBox.ItemTemplate>
						</ListBox>
					</TreeViewItem>

					<!-- Â∑≤ÂÆåÊàêÁªÑ -->
					<TreeViewItem>
						<TreeViewItem.Header>
							<StackPanel Orientation="Horizontal">
								<TextBlock>Â∑≤ÂÆåÊàêÔºö</TextBlock>
								<TextBlock Text="{Binding CurrentTodoGroupFinishItems.Length}"/>
							</StackPanel>
						</TreeViewItem.Header>

						<ListBox ItemsSource="{Binding CurrentTodoGroupFinishItems}"
								 Name="FinishedTodoItemListBox">
							<ListBox.ContextMenu>
								<ContextMenu Name="TodoGroupFinishItems_ContextMenu">
									<MenuItem Header="Â§çÂà∂"
											  Click="Async_CopySelectedFinishTodoItemTitle"
											  ToolTip.Tip="Â§çÂà∂ÈÄâ‰∏≠ÂæÖÂäû‰∫ãÈ°πÊ†áÈ¢ò"
											  ToolTip.ShowDelay="3"/>
									<MenuItem Header="Âà†Èô§"
											  Click="RemoveSelectedFinishTodoItemTitle"
											  ToolTip.Tip="Âà†Èô§ÈÄâ‰∏≠ÂæÖÂäû‰∫ãÈ°π"
											  ToolTip.ShowDelay="3"/>
								</ContextMenu>
							</ListBox.ContextMenu>

							<ListBox.ItemTemplate>
								<DataTemplate x:DataType="modles:TodoItem">
									<!-- ÈÄâÈ°πÂç° -->
									<Expander HorizontalContentAlignment="Stretch"
										  Expanded="TodoItemListBox_Expander_Expanded">
										<Expander.Header>
											<DockPanel>
												<CheckBox DockPanel.Dock="Left"
														  IsChecked="{Binding IsFinish}"
														  Checked="TodoGroupItems_SwitchTodoItemFinishStatus"
														  Unchecked="TodoGroupItems_SwitchTodoItemFinishStatus">
													<TextBlock Text="{Binding Title}"
															   TextDecorations="Strikethrough"
															   Foreground="Gray"/>
												</CheckBox>
											</DockPanel>
										</Expander.Header>

										<!-- ËØ¶ÁªÜ‰ø°ÊÅØ -->
										<Grid ColumnDefinitions="*"
											  RowDefinitions="*,*,*,*">
											<TextBox Name="InputTitle"
													 Grid.Row="0"
													 Grid.Column="0"
													 HorizontalAlignment="Stretch"
													 VerticalAlignment="Center"
													 Text="{Binding Title}"
													 Watermark="Ê†áÈ¢ò..."
												     TextWrapping="NoWrap"
													 ToolTip.Tip="ËæìÂÖ•Ê†áÈ¢ò"
													 ToolTip.ShowDelay="3"/>

											<CalendarDatePicker Name="InputDeadLine"
																Grid.Row="1"
																Grid.Column="0"
																HorizontalAlignment="Stretch"
																VerticalAlignment="Center"
																IsTodayHighlighted="True"
																SelectedDate="{Binding DeadLine}"
																ToolTip.Tip="Êà™Ê≠¢Êó•Êúü"
																ToolTip.ShowDelay="3"/>

											<TextBox Name="InputDescription"
													 Grid.Row="2"
													 Grid.Column="0"
													 HorizontalAlignment="Stretch"
													 VerticalAlignment="Stretch"
													 Height="100"
												     Text="{Binding Description}"
													 Watermark="Ê∑ªÂä†Â§áÊ≥®..."
													 AcceptsReturn="True"
													 TextWrapping="Wrap"
													 TextAlignment="Justify"
													 ToolTip.Tip="Â§áÊ≥®"
													 ToolTip.ShowDelay="3"/>

											<TextBlock/>

											<Button Grid.Row="3"
													Grid.Column="0"
													HorizontalAlignment="Stretch"
													VerticalAlignment="Stretch"
													Classes="Success"
													Theme="{DynamicResource SolidButton}"
													Click="TodoItemList_CommitTodoItemInfo">
												Êèê‰∫§
											</Button>
										</Grid>

									</Expander>
								</DataTemplate>
							</ListBox.ItemTemplate>
						</ListBox>


					</TreeViewItem>
				</TreeView>

			</DockPanel>
		</Grid>

	</Panel>

</Window>
